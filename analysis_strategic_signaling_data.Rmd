---
title: "Analysis of Covert Signaling Data"
author: "David Bailey"
---

```{r config}
library(dplyr)
library(tidyr)
```


## Read in and pre-process data

```{r}

# Reading in data
df <- read.csv("data/strategic_signaling_data_long.csv")

# Filtering co-partisan tweets only:
df_co <- df %>% 
  filter(co_cross == 'co') %>%
  select(-tweet) # Drop tweet column for predictions

# Filtering cross-partisan tweets only:
df_cross <- df %>% 
  filter(co_cross == 'cross') %>%
  select(-tweet)

```

## Save files

```{r}
#write.csv(df, 'data/strategic_signaling_data_wide.csv', row.names=FALSE)
#write.csv(df_long, 'data/strategic_signaling_data_long.csv', row.names=FALSE)
```


### CO-PARTISAN TWEET MODELS ###

## Sentiment by average perceived copartisanship and political affiliation (left = 0):

```{r}

# Centering intercept on left-wing participants:
df_co$poli_affil <- relevel(factor(df_co$poli_affil), 'left')

# Model with interaction between perceived copartisanship and political affiliation:
co_model_left <- lm(avg_sentiment ~avg_perceived*poli_affil, data=df_co)


summary(co_model_left)

```


## Sentiment by average perceived copartisanship and political affiliation (right = 0):

```{r}

df_co$poli_affil<- relevel(factor(df_co$poli_affil), 'right')
co_model_right <- lm(avg_sentiment ~ avg_perceived*poli_affil, data=df_co)
summary(co_model_right)

```


# Sentiment by average perceived copartisanship and moderate/radical identification (left group, radical = 0)

```{r}

df_co_lib <- df_co %>% filter(poli_affil == 'left')

df_co_lib$mod_rad <- relevel(factor(df_co_lib$mod_rad), 'radical')

# Model with interaction between perceived copartisanship and political affiliation:
co_model_left_rad <- lm(avg_sentiment ~avg_perceived*mod_rad, data=df_co_lib)

summary(co_model_left_rad)

```


# Sentiment by average perceived copartisanship and moderate/radical identification (right group, radical = 0)

```{r}

df_co_con <- df_co %>% filter(poli_affil == 'right')

df_co_con$mod_rad <- relevel(factor(df_co_con$mod_rad), 'radical')

# Model with interaction between perceived copartisanship and political affiliation:
co_model_right_rad <- lm(avg_sentiment ~avg_perceived*mod_rad, data=df_co_con)

summary(co_model_right_rad)

```


# Sentiment by average perceived copartisanship and moderate/radical identification (left group, moderate = 0)

```{r}

df_co_lib$mod_rad <- relevel(factor(df_co_lib$mod_rad), 'moderate')

# Model with interaction between perceived copartisanship and political affiliation:
co_model_left_mod <- lm(avg_sentiment ~avg_perceived*mod_rad, data=df_co_lib)

summary(co_model_left_mod)

```


# Sentiment by average perceived copartisanship and moderate/radical identification (right group, moderate = 0)

```{r}

df_co_con$mod_rad <- relevel(factor(df_co_con$mod_rad), 'moderate')

# Model with interaction between perceived copartisanship and political affiliation:
co_model_right_mod <- lm(avg_sentiment ~avg_perceived*mod_rad, data=df_co_con)

summary(co_model_right_mod)

```

# Average perceived copartisanship and political affiliation model testing for main effect of average perceived

```{r}

# Effect coding at -1 and 1:
df_co$poli_affil_coded <- ifelse(df_co$poli_affil == 'left', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
co_model_poli_affil <- lm(avg_sentiment ~avg_perceived*poli_affil_coded, data=df_co)

# Political affiliation model:
summary(co_model_poli_affil)

```

# Average perceived and moderate/radical model testing for main effect of average perceived (left)

```{r}

df_co_lib$mod_rad_coded <- ifelse(df_co_lib$mod_rad == 'moderate', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
co_model_left_mod_rad <- lm(avg_sentiment ~avg_perceived*mod_rad_coded, data=df_co_lib)

summary(co_model_left_mod_rad)

```

# Average perceived and moderate/radical model testing for main effect of average perceived (right)

```{r}

df_co_con$mod_rad_coded <- ifelse(df_co_con$mod_rad == 'moderate', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
co_model_right_mod_rad <- lm(avg_sentiment ~avg_perceived*mod_rad_coded, data=df_co_con)

summary(co_model_right_mod_rad)

```


### CROSS-PARTISAN TWEET MODELS ###

## Average perceived and political affiliation (left = 0)

```{r}

df_cross$poli_affil <- relevel(factor(df_cross$poli_affil), 'left')

cross_model_left <- lm(avg_sentiment ~ avg_perceived*poli_affil, data=df_cross)

summary(cross_model_left)

```

## Average perceived copartisanship and political affiliation (right = 0)

```{r}
df_cross$poli_affil <- relevel(factor(df_cross$poli_affil), 'right')

cross_model_con <- lm(avg_sentiment ~ avg_perceived*poli_affil, data=df_cross)

summary(cross_model_con)
```

## Average perceived and moderate/radical identification (left participants, radical = 0)

```{r}

df_cross_lib <- df_cross %>% filter(poli_affil == 'left')

df_cross_lib$mod_rad <- relevel(factor(df_cross_lib$mod_rad), 'radical')

# Model with interaction between perceived copartisanship and political affiliation:
cross_model_left_rad <- lm(avg_sentiment ~avg_perceived*mod_rad, data=df_cross_lib)

summary(cross_model_left_rad)

```

## Average perceived and moderate/radical identification (right participants, radical = 0)

```{r}
df_cross_con <- df_cross %>% filter(poli_affil == 'right')

df_cross_con$mod_rad <- relevel(factor(df_cross_con$mod_rad), 'radical')

# Model with interaction between perceived copartisanship and political affiliation:
cross_model_right_rad <- lm(avg_sentiment ~avg_perceived*mod_rad, data=df_cross_con)

summary(cross_model_right_rad)
```


## Average perceived and moderate/radical identification (left participants, moderate = 0)

```{r}

df_cross_lib <- df_cross %>% filter(poli_affil == 'left')

df_cross_lib$mod_rad <- relevel(factor(df_cross_lib$mod_rad), 'moderate')

# Model with interaction between perceived copartisanship and political affiliation:
cross_model_left_mod <- lm(avg_sentiment ~avg_perceived*mod_rad, data=df_cross_lib)

summary(cross_model_left_mod)

```


## Average perceived and moderate/radical identification (right participants, moderate = 0)

```{r}
df_cross_con <- df_cross %>% filter(poli_affil == 'right')

df_cross_con$mod_rad <- relevel(factor(df_cross_con$mod_rad), 'moderate')

# Model with interaction between perceived copartisanship and political affiliation:
cross_model_right_mod <- lm(avg_sentiment ~avg_perceived*mod_rad, data=df_cross_con)

summary(cross_model_right_mod)
```

## Average perceived and political affiliation (test for main effect of average perceived)

```{r}

# Effect coding at -1 and 1:
df_cross$poli_affil_coded <- ifelse(df_cross$poli_affil == 'left', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
cross_model_poli_affil <- lm(avg_sentiment ~avg_perceived*poli_affil_coded, data=df_cross)

# Political affiliation model:
summary(cross_model_poli_affil)

```

## Average perceived and moderate/radical ID (left participants, test for main effect of average perceived)

```{r}

df_cross_lib$mod_rad_coded <- ifelse(df_cross_lib$mod_rad == 'moderate', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
cross_model_left_mod_rad <- lm(avg_sentiment ~avg_perceived*mod_rad_coded, data=df_cross_lib)

summary(cross_model_left_mod_rad)
```

## Average perceived and moderate/radical ID (right participants, test for main effect of average perceived)

```{r}
df_cross_con$mod_rad_coded <- ifelse(df_cross_con$mod_rad == 'moderate', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
cross_model_right_mod_rad <- lm(avg_sentiment ~avg_perceived*mod_rad_coded, data=df_cross_con)

summary(cross_model_right_mod_rad)
```

