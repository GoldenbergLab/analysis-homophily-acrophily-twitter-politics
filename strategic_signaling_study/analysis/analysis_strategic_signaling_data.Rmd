---
title: "Analysis of Strategic Signaling Data"
author: "David Bailey"
---


## Read in and pre-process data

```{r seeting data and libraries}
library(tidyverse)
library(lme4)
library (lmerTest)
# Reading in data
df <- read.csv("../data/strategic_signaling_data_long.csv")

# Filter out moderate responses:
 df <- df %>%
   filter(avg_perceived != 4.0)

# Filtering co-partisan tweets only:
df_co <- df %>% 
  filter(co_cross == 'co') 

# Filtering cross-partisan tweets only:
df_cross <- df %>% 
  filter(co_cross == 'cross') 

# Filtering to general groups only:
df_co_gen <- df_co %>%
  filter(is_moderate == 'no')

df_cross_gen <- df_cross %>%
  filter(is_moderate == 'no')

# Filtering to moderates only:
df_co_mod <- df_co %>%
  filter(is_moderate == 'yes')

df_cross_mod <- df_cross %>%
  filter(is_moderate == 'yes')




```


```{r descriptives}

length(unique(df_co$tweet))

des = df_co_gen %>% 
  group_by (tweet) %>% 
  slice(1)


mean(des$viewed_all)
sd(des$viewed_all)

min(des$amount)
table(des$amount)
```


## Co-partisan Tweet Only Models

### Average sentiment by average perceived and political affiliation (groups overall)

```{r general}
df_co_gen$poli_affil = factor(df_co_gen$poli_affil)
# Effect coding at 1 and -1:
df_co_gen$poli_affil_coded <- ifelse(df_co_gen$poli_affil == 'left', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
co_gen_model_coded <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil_coded + viewed_all, data=df_co_gen) ;summary(co_gen_model_coded)

confint(co_gen_model_coded)

#look at simple effects
r <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil + viewed_all, data=df_co_gen) ;summary(r)

df_co_gen$poli_affil = relevel(df_co_gen$poli_affil, "right")

r <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil + viewed_all, data=df_co_gen) ;summary(r)


confint(co_gen_model_coded)


```



### Average sentiment by average perceived and political affiliation (moderates only)


```{r}
# Effect coded at 1 and -1:
df_co_mod$poli_affil_coded <- ifelse(df_co_mod$poli_affil == 'left', 1, -1)

df_co_mod$poli_affil = factor(df_co_mod$poli_affil)

# Effect coded at 1 and -1:
df_co_mod$poli_affil_coded <- ifelse(df_co_mod$poli_affil == 'left', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
r <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil_coded + viewed_all, data=df_co_mod) ;summary(r)

confint(r)

#look at simple effects
r <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil + viewed_all, data=df_co_mod) ;summary(r)

df_co_mod$poli_affil = relevel(df_co_mod$poli_affil, "right")


r <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil + viewed_all, data=df_co_mod) ;summary(r)

confint(r)
```


```{r}
# Centering intercept on left-wing participants:
df_co_mod$poli_affil <- relevel(factor(df_co_mod$poli_affil), 'left')

# Model with interaction between perceived copartisanship and political affiliation:
co_mod_model_left <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil + viewed_all, data=df_co_mod)


summary(co_mod_model_left)
```


```{r}
# Centering intercept on right-wing participants:
df_co_mod$poli_affil <- relevel(factor(df_co_mod$poli_affil), 'right')

# Model with interaction between perceived copartisanship and political affiliation:
co_mod_model_right <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil + viewed_all, data=df_co_mod)


summary(co_mod_model_right)

```

## Cross-partisan Tweet Only Models

### Average sentiment by average perceived and political affiliation (groups overall)

```{r}
# Centering intercept on left-wing participants:
df_cross_gen$poli_affil <- relevel(factor(df_cross_gen$poli_affil), 'left')

# Model with interaction between perceived copartisanship and political affiliation:
cross_gen_model_left <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil + viewed_all, data=df_cross_gen)


summary(cross_gen_model_left)

```


```{r}

# Centering intercept on right-wing participants:
df_cross_gen$poli_affil <- relevel(factor(df_cross_gen$poli_affil), 'right')

# Model with interaction between perceived copartisanship and political affiliation:
cross_gen_model_right <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil + viewed_all, data=df_cross_gen)


summary(cross_gen_model_right)

```


```{r}
# Effect coding at 1 and -1:
df_cross_gen$poli_affil_coded <- ifelse(df_cross_gen$poli_affil == 'left', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
cross_gen_model_coded <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil_coded + viewed_all, data=df_cross_gen)


summary(cross_gen_model_coded)
```

### Average sentiment by average perceived and political affiliation (moderates only)

```{r}
# Centering intercept on left-wing participants:
df_cross_mod$poli_affil <- relevel(factor(df_cross_mod$poli_affil), 'left')

# Model with interaction between perceived copartisanship and political affiliation:
cross_mod_model_left <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil + viewed_all, data=df_cross_mod)


summary(cross_mod_model_left)
```


```{r}
# Centering intercept on right-wing participants:
df_cross_mod$poli_affil <- relevel(factor(df_cross_mod$poli_affil), 'right')

# Model with interaction between perceived copartisanship and political affiliation:
cross_mod_model_right <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil + viewed_all, data=df_cross_mod)


summary(cross_mod_model_right)
```


```{r}
# Effect coded at 1 and -1:
df_cross_mod$poli_affil_coded <- ifelse(df_cross_mod$poli_affil == 'left', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
cross_mod_model_coded <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil_coded + viewed_all, data=df_cross_mod)


summary(cross_mod_model_coded)
```


