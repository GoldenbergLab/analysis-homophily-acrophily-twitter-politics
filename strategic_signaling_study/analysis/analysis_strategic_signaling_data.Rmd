---
title: "Analysis of Covert Signaling Data"
author: "David Bailey"
---

```{r read in the data}
library(tidyverse)

df <- read.csv("../data/strategic_signaling_data_long.csv")

# Filtering co-partisan tweets only:
df_co <- df %>% 
  filter(co_cross == 'co') %>%
  select(-tweet) # Drop tweet column for predictions

# Filtering cross-partisan tweets only:
df_cross <- df %>% 
  filter(co_cross == 'cross') %>%
  select(-tweet)

# Filtering to general groups only:
df_co_gen <- df_co %>%
  filter(is_moderate == 'no')

df_cross_gen <- df_cross %>%
  filter(is_moderate == 'no')

# Filtering to moderates only:
df_co_mod <- df_co %>%
  filter(is_moderate == 'yes')

df_cross_mod <- df_cross %>%
  filter(is_moderate == 'yes')

```


## Co-partisan Tweet Only Models

### Average sentiment by average perceived and political affiliation (groups overall)

```{r}
# Effect coding at 1 and -1:
df_co_gen$poli_affil_coded <- ifelse(df_co_gen$poli_affil == 'left', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
co_gen_model_coded <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil_coded, data=df_co_gen)


summary(co_gen_model_coded)
```


```{r}
# Centering intercept on left-wing participants:
df_co_gen$poli_affil <- relevel(factor(df_co_gen$poli_affil), 'left')

# Model with interaction between perceived copartisanship and political affiliation:
co_gen_model_left <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil, data=df_co_gen)


summary(co_gen_model_left)

```


```{r}

# Centering intercept on right-wing participants:
df_co_gen$poli_affil <- relevel(factor(df_co_gen$poli_affil), 'right')

# Model with interaction between perceived copartisanship and political affiliation:
co_gen_model_right <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil, data=df_co_gen)


summary(co_gen_model_right)

```

### Average sentiment by average perceived and political affiliation (moderates only)


```{r}
# Effect coded at 1 and -1:
df_co_mod$poli_affil_coded <- ifelse(df_co_mod$poli_affil == 'left', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
co_mod_model_coded <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil_coded, data=df_co_mod)


summary(co_mod_model_coded)
```


```{r}
# Centering intercept on left-wing participants:
df_co_mod$poli_affil <- relevel(factor(df_co_mod$poli_affil), 'left')

# Model with interaction between perceived copartisanship and political affiliation:
co_mod_model_left <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil, data=df_co_mod)


summary(co_mod_model_left)
```


```{r}
# Centering intercept on right-wing participants:
df_co_mod$poli_affil <- relevel(factor(df_co_mod$poli_affil), 'right')

# Model with interaction between perceived copartisanship and political affiliation:
co_mod_model_right <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil, data=df_co_mod)


summary(co_mod_model_right)

```

## Cross-partisan Tweet Only Models

### Average sentiment by average perceived and political affiliation (groups overall)

```{r}
# Centering intercept on left-wing participants:
df_cross_gen$poli_affil <- relevel(factor(df_cross_gen$poli_affil), 'left')

# Model with interaction between perceived copartisanship and political affiliation:
cross_gen_model_left <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil, data=df_cross_gen)


summary(cross_gen_model_left)

```


```{r}

# Centering intercept on right-wing participants:
df_cross_gen$poli_affil <- relevel(factor(df_cross_gen$poli_affil), 'right')

# Model with interaction between perceived copartisanship and political affiliation:
cross_gen_model_right <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil, data=df_cross_gen)


summary(cross_gen_model_right)

```


```{r}
# Effect coding at 1 and -1:
df_cross_gen$poli_affil_coded <- ifelse(df_cross_gen$poli_affil == 'left', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
cross_gen_model_coded <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil_coded, data=df_cross_gen)


summary(cross_gen_model_coded)
```

### Average sentiment by average perceived and political affiliation (moderates only)

```{r}
# Centering intercept on left-wing participants:
df_cross_mod$poli_affil <- relevel(factor(df_cross_mod$poli_affil), 'left')

# Model with interaction between perceived copartisanship and political affiliation:
cross_mod_model_left <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil, data=df_cross_mod)


summary(cross_mod_model_left)
```


```{r}
# Centering intercept on right-wing participants:
df_cross_mod$poli_affil <- relevel(factor(df_cross_mod$poli_affil), 'right')

# Model with interaction between perceived copartisanship and political affiliation:
cross_mod_model_right <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil, data=df_cross_mod)


summary(cross_mod_model_right)
```


```{r}
# Effect coded at 1 and -1:
df_cross_mod$poli_affil_coded <- ifelse(df_cross_mod$poli_affil == 'left', 1, -1)

# Model with interaction between perceived copartisanship and political affiliation:
cross_mod_model_coded <- lm(avg_sentiment ~scale(avg_perceived)*poli_affil_coded, data=df_cross_mod)


summary(cross_mod_model_coded)
```


